<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Drasi + Dapr: Supercharging Microservices with Change Detection</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reset.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/theme/black.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/highlight/monokai.css">
    
    <style>
        :root {
            --r-background-color: #1a1a2e;
            --r-main-color: #eee;
            --r-heading-color: #61dafb;
            --r-link-color: #61dafb;
            --r-selection-background-color: #61dafb;
            --dapr-blue: #0d6efd;
            --drasi-green: #00d4aa;
        }
        
        .reveal .slides section {
            text-align: left;
        }
        
        .reveal h1, .reveal h2, .reveal h3, .reveal h4 {
            text-align: center;
            color: var(--r-heading-color);
        }
        
        .reveal .center {
            text-align: center;
        }
        
        .logo-container {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .logo-container img {
            height: 40px;
        }
        
        .highlight-dapr {
            color: var(--dapr-blue);
            font-weight: bold;
        }
        
        .highlight-drasi {
            color: var(--drasi-green);
            font-weight: bold;
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: start;
        }
        
        .feature-box {
            background: rgba(255,255,255,0.05);
            border: 2px solid var(--r-heading-color);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .emoji-large {
            font-size: 2em;
            margin: 0 10px;
        }
        
        .code-small {
            font-size: 0.7em;
        }
        
        .mermaid {
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 10px;
        }
        
        .demo-step {
            background: rgba(0,0,0,0.3);
            border-left: 4px solid var(--drasi-green);
            padding: 15px;
            margin: 10px 0;
        }
        
        .reaction-badge {
            display: inline-block;
            background: var(--drasi-green);
            color: black;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin: 10px 5px;
        }
        
        pre code {
            font-size: 0.8em;
            line-height: 1.2;
        }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">
            <!-- Title Slide -->
            <section data-background-color="#1a1a2e">
                <h1>Drasi + Dapr</h1>
                <h3>Supercharging Microservices with<br/>Intelligent Change Detection</h3>
                <div class="center" style="margin-top: 50px;">
                    <p><span class="emoji-large">üöÄ</span> Real-time Data ‚Ä¢ Event-Driven ‚Ä¢ Zero Code Changes</p>
                </div>
                <div class="logo-container">
                    <img src="images/cncf-logo.png" alt="CNCF">
                    <img src="images/drasi-logo.png" alt="Drasi">
                </div>
            </section>

            <!-- Agenda -->
            <section>
                <h2>Agenda</h2>
                <div class="feature-box">
                    <p><span class="emoji-large">1Ô∏è‚É£</span> <strong>Introduction:</strong> What is Drasi & Why Dapr Users Need It</p>
                    <p><span class="emoji-large">2Ô∏è‚É£</span> <strong>Demo - SignalR:</strong> Real-time Dashboard without Polling</p>
                    <p><span class="emoji-large">3Ô∏è‚É£</span> <strong>Demo - State Sync:</strong> Pre-computed Read Models</p>
                    <p><span class="emoji-large">4Ô∏è‚É£</span> <strong>Demo - Pub/Sub:</strong> Business Event Generation</p>
                </div>
            </section>

            <!-- Phase 1: Introduction -->
            <section>
                <section>
                    <h2>The Challenge</h2>
                    <div class="two-column">
                        <div>
                            <h4>What Dapr Gives You</h4>
                            <ul>
                                <li>üîß Service Invocation</li>
                                <li>üíæ State Management</li>
                                <li>üì¨ Pub/Sub Messaging</li>
                                <li>üîê Secrets Management</li>
                                <li>‚öôÔ∏è Configuration</li>
                            </ul>
                        </div>
                        <div>
                            <h4>What's Still Hard</h4>
                            <ul>
                                <li>‚ùì Detecting complex changes</li>
                                <li>‚ùì Real-time UI updates</li>
                                <li>‚ùì Cross-service queries</li>
                                <li>‚ùì Time-based business logic</li>
                                <li>‚ùì Event enrichment</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section>
                    <h2>Enter Drasi</h2>
                    <div class="center">
                        <h3>A Data Change Processing Platform</h3>
                    </div>
                    <div class="mermaid">
                        <pre class="mermaid">
                        graph LR
                            A[Dapr Services] -->|State Changes| B[Drasi Sources]
                            B --> C[Continuous Queries]
                            C -->|Business Events| D[Reactions]
                            D --> E[Your Apps]
                            style A fill:#0d6efd
                            style C fill:#00d4aa
                            style D fill:#00d4aa
                        </pre>
                    </div>
                    <div class="center" style="margin-top: 30px;">
                        <p><strong>Key Insight:</strong> Drasi watches your Dapr state stores and tells you what changed and why it matters</p>
                    </div>
                </section>

                <section>
                    <h2>Drasi's Three Core Concepts</h2>
                    <div class="feature-box">
                        <h3>1. Sources</h3>
                        <p>Connect to your data stores (PostgreSQL, Cosmos DB, etc.)</p>
                    </div>
                    <div class="feature-box">
                        <h3>2. Continuous Queries</h3>
                        <p>Graph queries (Cypher) that run forever, detecting changes</p>
                    </div>
                    <div class="feature-box">
                        <h3>3. Reactions</h3>
                        <p>Take action when changes occur</p>
                        <span class="reaction-badge">SignalR</span>
                        <span class="reaction-badge">SyncDaprStateStore</span>
                        <span class="reaction-badge">PostDaprPubSub</span>
                    </div>
                </section>

                <section>
                    <h2>Our Demo E-commerce System</h2>
                    <div class="mermaid">
                        <pre class="mermaid">
                        graph TB
                            subgraph "Dapr Microservices"
                                P[Products Service]
                                C[Customers Service]
                                O[Orders Service]
                                R[Reviews Service]
                            end
                            subgraph "Drasi-Powered Services"
                                D[Dashboard]
                                CAT[Catalogue Service]
                                N[Notifications Service]
                            end
                            style P fill:#0d6efd
                            style C fill:#0d6efd
                            style O fill:#0d6efd
                            style R fill:#0d6efd
                            style D fill:#00d4aa
                            style CAT fill:#00d4aa
                            style N fill:#00d4aa
                        </pre>
                    </div>
                </section>
            </section>

            <!-- Phase 2: SignalR Demo -->
            <section>
                <section data-background-color="#16213e">
                    <h1>Demo 1: SignalR Reaction</h1>
                    <h3>Real-time Dashboard Without Polling</h3>
                    <div class="center">
                        <span class="emoji-large">üìä</span>
                        <span class="emoji-large">‚ö°</span>
                        <span class="emoji-large">üîÑ</span>
                    </div>
                </section>

                <section>
                    <h2>The Business Need</h2>
                    <div class="feature-box">
                        <h3>Operations Dashboard Requirements</h3>
                        <ul>
                            <li>üì¶ Track orders containing specific products</li>
                            <li>‚è±Ô∏è Alert on delayed GOLD customer orders</li>
                            <li>üö® Real-time updates without page refresh</li>
                            <li>üéØ Take immediate action (backorder/cancel)</li>
                        </ul>
                    </div>
                </section>

                <section>
                    <h2>Drasi Query: Delayed Gold Orders</h2>
                    <pre><code class="language-cypher">MATCH
    (o:orders)-[:ORDER_TO_CUSTOMER]->(c:customers)
WHERE
    c.loyaltyTier = 'GOLD'
WITH
    o, c, drasi.changeDateTime(o) as waitingSince
WHERE
    drasi.trueFor(o.orderStatus = 'PROCESSING', duration({seconds: 10}))
RETURN
    o.orderId, c.customerName, c.customerEmail, waitingSince</code></pre>
                    <div class="center">
                        <p><strong>Magic:</strong> <code>drasi.trueFor()</code> detects time-based conditions!</p>
                    </div>
                </section>

                <section>
                    <h2>Live Demo Steps</h2>
                    <div class="demo-step">
                        <h4>1. Create VIP Customer & Product</h4>
                        <pre class="code-small"><code class="language-bash">curl -X POST http://localhost/customers-service/customers \
  -d '{"customerId": 5001, "customerName": "VIP Customer", 
       "loyaltyTier": "GOLD"}'</code></pre>
                    </div>
                    <div class="demo-step">
                        <h4>2. Create Order & Watch Dashboard Update</h4>
                        <pre class="code-small"><code class="language-bash">curl -X POST http://localhost/orders-service/orders \
  -d '{"customerId": 5001, "items": [{"productId": 1010, "quantity": 1}]}'</code></pre>
                    </div>
                    <div class="demo-step">
                        <h4>3. Set to PROCESSING & See Delay Detection</h4>
                        <p>After 10 seconds, order automatically appears in "Delayed Orders" section!</p>
                    </div>
                </section>

                <section>
                    <h2>Frontend Integration</h2>
                    <pre><code class="language-jsx">import { ResultSet } from '@drasi/signalr-react';

function Dashboard() {
  return (
    <ResultSet 
      url="http://localhost:8080/hub" 
      queryId="delayed-gold-orders-query"
    >
      {order => (
        <OrderCard order={order} />
      )}
    </ResultSet>
  );
}</code></pre>
                    <div class="center feature-box">
                        <p>‚ú® <strong>That's it!</strong> No polling, no WebSocket code, just reactive UI</p>
                    </div>
                </section>
            </section>

            <!-- Phase 3: State Store Sync Demo -->
            <section>
                <section data-background-color="#16213e">
                    <h1>Demo 2: SyncDaprStateStore</h1>
                    <h3>Pre-computed Read Models for Performance</h3>
                    <div class="center">
                        <span class="emoji-large">üóÑÔ∏è</span>
                        <span class="emoji-large">üöÄ</span>
                        <span class="emoji-large">üìä</span>
                    </div>
                </section>

                <section>
                    <h2>The Business Need</h2>
                    <div class="feature-box">
                        <h3>Product Catalogue Requirements</h3>
                        <ul>
                            <li>üõçÔ∏è Show products with ratings and order stats</li>
                            <li>‚ö° Sub-millisecond response times</li>
                            <li>üîÑ Always up-to-date information</li>
                            <li>üö´ No complex joins at query time</li>
                        </ul>
                    </div>
                </section>

                <section>
                    <h2>Drasi Query: Product Catalogue</h2>
                    <pre><code class="language-cypher">MATCH
    (p:products)-[:PRODUCT_TO_ORDER_ITEM]->(oi:orderItem),
    (r:reviews)-[:REVIEW_TO_PRODUCT]->(p)
WITH
    p, count(DISTINCT oi) as orderCount, 
    avg(r.rating) as avgRating, count(r) as reviewCount
RETURN
    p.productId, p.productName, 
    orderCount, avgRating, reviewCount</code></pre>
                    <div class="center">
                        <p><strong>Result:</strong> Materialized in catalogue service's state store</p>
                    </div>
                </section>

                <section>
                    <h2>How It Works</h2>
                    <div class="mermaid">
                        <pre class="mermaid">
                        sequenceDiagram
                            participant P as Products Service
                            participant R as Reviews Service
                            participant D as Drasi Query
                            participant C as Catalogue State
                            participant A as Your API
                            
                            P->>D: Product Updated
                            R->>D: New Review Added
                            D->>D: Recalculate Aggregations
                            D->>C: Update State Store
                            A->>C: Simple Key Lookup
                            C->>A: Enriched Data (fast!)
                        </pre>
                    </div>
                </section>

                <section>
                    <h2>Live Demo Steps</h2>
                    <div class="demo-step">
                        <h4>1. Create Product with Reviews</h4>
                        <pre class="code-small"><code class="language-bash"># Create product, add reviews
curl -X POST http://localhost/reviews-service/reviews \
  -d '{"productId": 2001, "customerId": 1001, "rating": 5}'</code></pre>
                    </div>
                    <div class="demo-step">
                        <h4>2. Check Catalogue - Instantly Updated!</h4>
                        <pre class="code-small"><code class="language-bash">curl http://localhost/catalogue-service/catalogue/2001
# Returns: avgRating: 5.0, reviewCount: 1</code></pre>
                    </div>
                    <div class="demo-step">
                        <h4>3. Add More Reviews - Watch Aggregations Update</h4>
                        <p>Every change automatically recalculates and updates the materialized view</p>
                    </div>
                </section>
            </section>

            <!-- Phase 4: Pub/Sub Demo -->
            <section>
                <section data-background-color="#16213e">
                    <h1>Demo 3: PostDaprPubSub</h1>
                    <h3>Business Events from Data Changes</h3>
                    <div class="center">
                        <span class="emoji-large">üì®</span>
                        <span class="emoji-large">üö®</span>
                        <span class="emoji-large">‚ö°</span>
                    </div>
                </section>

                <section>
                    <h2>The Business Need</h2>
                    <div class="feature-box">
                        <h3>Inventory Alert Requirements</h3>
                        <ul>
                            <li>‚ö†Ô∏è Alert purchasing when stock is low</li>
                            <li>üö® Critical alerts for out-of-stock</li>
                            <li>üìß Different teams, different actions</li>
                            <li>üéØ Only alert on actual changes</li>
                        </ul>
                    </div>
                </section>

                <section>
                    <h2>Two Drasi Queries</h2>
                    <div class="two-column">
                        <div class="feature-box">
                            <h4>Low Stock Event</h4>
                            <pre class="code-small"><code class="language-cypher">MATCH (p:products)
WHERE 
  p.stockOnHand <= p.lowStockThreshold 
  AND p.stockOnHand > 0
RETURN p.productId, p.productName, 
       p.stockOnHand</code></pre>
                        </div>
                        <div class="feature-box">
                            <h4>Critical Stock Event</h4>
                            <pre class="code-small"><code class="language-cypher">MATCH (p:products)
WHERE p.stockOnHand = 0
RETURN p.productId, p.productName</code></pre>
                        </div>
                    </div>
                </section>

                <section>
                    <h2>Event Flow</h2>
                    <div class="mermaid">
                        <pre class="mermaid">
                        graph LR
                            A[Product Stock Changes] -->|Drasi Detects| B{Stock Level?}
                            B -->|Low| C[Low Stock Event]
                            B -->|Zero| D[Critical Event]
                            C -->|Pub/Sub| E[üìß Purchasing Team]
                            D -->|Pub/Sub| F[üö® Multiple Teams]
                            style B fill:#00d4aa
                            style C fill:#ffa500
                            style D fill:#ff0000
                        </pre>
                    </div>
                </section>

                <section>
                    <h2>Live Demo Steps</h2>
                    <div class="demo-step">
                        <h4>1. Create Product Near Threshold</h4>
                        <pre class="code-small"><code class="language-bash">curl -X POST http://localhost/products-service/products \
  -d '{"productId": 3001, "stockOnHand": 25, "lowStockThreshold": 20}'</code></pre>
                    </div>
                    <div class="demo-step">
                        <h4>2. Trigger Low Stock Alert</h4>
                        <pre class="code-small"><code class="language-bash"># Decrement by 10 units
# üìß EMAIL TO: purchasing@company.com
# Subject: Low Stock Alert - Bluetooth Speaker</code></pre>
                    </div>
                    <div class="demo-step">
                        <h4>3. Trigger Critical Alert</h4>
                        <pre class="code-small"><code class="language-bash"># Decrement to zero
# üö® CRITICAL: Multiple notifications sent!
# Sales team: Halt all sales
# Fulfillment: Review pending orders</code></pre>
                    </div>
                </section>

                <section>
                    <h2>CloudEvents Format</h2>
                    <pre><code class="language-json">{
  "specversion": "1.0",
  "type": "com.dapr.event.sent",
  "source": "drasi-reaction",
  "data": {
    "op": "i",  // insert (low stock detected)
    "payload": {
      "after": {
        "productId": 3001,
        "productName": "Bluetooth Speaker",
        "stockOnHand": 15,
        "lowStockThreshold": 20
      }
    }
  }
}</code></pre>
                </section>
            </section>

            <!-- Summary -->
            <section>
                <section>
                    <h2>What We've Demonstrated</h2>
                    <div class="two-column">
                        <div class="feature-box">
                            <h3>üñ•Ô∏è SignalR</h3>
                            <ul>
                                <li>Real-time dashboards</li>
                                <li>Zero polling overhead</li>
                                <li>Time-based detection</li>
                            </ul>
                        </div>
                        <div class="feature-box">
                            <h3>üíæ State Sync</h3>
                            <ul>
                                <li>Pre-computed views</li>
                                <li>Cross-service aggregation</li>
                                <li>Microsecond lookups</li>
                            </ul>
                        </div>
                    </div>
                    <div class="feature-box" style="margin-top: 20px;">
                        <h3>üì¨ Pub/Sub</h3>
                        <ul>
                            <li>Business event generation</li>
                            <li>Intelligent notifications</li>
                            <li>CloudEvents standard</li>
                        </ul>
                    </div>
                </section>

                <section>
                    <h2>Key Benefits for Dapr Users</h2>
                    <div class="feature-box">
                        <p>‚úÖ <strong>No Service Changes:</strong> Add capabilities without modifying existing code</p>
                        <p>‚úÖ <strong>Declarative:</strong> Express complex logic in simple queries</p>
                        <p>‚úÖ <strong>Performance:</strong> Pre-compute expensive operations</p>
                        <p>‚úÖ <strong>Real-time:</strong> Push-based updates, not polling</p>
                        <p>‚úÖ <strong>Scalable:</strong> Each component scales independently</p>
                    </div>
                </section>

                <section>
                    <h2>Getting Started</h2>
                    <div class="demo-step">
                        <h4>1. Install Drasi</h4>
                        <pre><code class="language-bash">drasi init</code></pre>
                    </div>
                    <div class="demo-step">
                        <h4>2. Connect Your Dapr State Store</h4>
                        <pre><code class="language-yaml">kind: Source
spec:
  kind: PostgreSQL
  properties:
    connectionString: "..."</code></pre>
                    </div>
                    <div class="demo-step">
                        <h4>3. Write a Query & Add a Reaction</h4>
                        <p>Start simple, expand as you learn!</p>
                    </div>
                </section>

                <section data-background-color="#1a1a2e">
                    <h1>Thank You!</h1>
                    <div class="center">
                        <h3>Questions?</h3>
                        <p style="margin-top: 50px;">
                            <strong>Learn More:</strong><br/>
                            üåê drasi.io<br/>
                            üìö github.com/drasi-project<br/>
                            üí¨ Join our community!
                        </p>
                    </div>
                    <div class="logo-container">
                        <img src="images/cncf-logo.png" alt="CNCF">
                        <img src="images/drasi-logo.png" alt="Drasi">
                    </div>
                </section>
            </section>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/dist/reveal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/highlight/highlight.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/markdown/markdown.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.5.0/plugin/notes/notes.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    
    <script>
        // Initialize Mermaid
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'dark',
            themeVariables: {
                primaryColor: '#00d4aa',
                primaryTextColor: '#fff',
                primaryBorderColor: '#00d4aa',
                lineColor: '#61dafb',
                secondaryColor: '#0d6efd',
                tertiaryColor: '#1a1a2e',
                background: '#1a1a2e',
                mainBkg: '#1a1a2e',
                secondBkg: '#0d6efd',
                tertiaryBkg: '#00d4aa'
            }
        });

        // Initialize Reveal.js
        Reveal.initialize({
            hash: true,
            controls: true,
            progress: true,
            center: false,
            transition: 'slide',
            plugins: [ RevealHighlight, RevealMarkdown, RevealNotes ]
        });

        // Re-render Mermaid diagrams when slide changes
        Reveal.on('slidechanged', function(event) {
            mermaid.init();
        });
    </script>
</body>
</html>